# bashrc extra functions written for AOSC OSes, package "hg"
# by Arthur Wang

[ "$TERMCOLOR"=="8" ] && IRED="\e[0;31m" || IRED="\e[0;91m"

# Aliases, mostly from http://blog.sina.com.cn/s/blog_630c58cb01011uid.html
# TODO To be updated
alias h="hg status"
alias ha="hg add"
alias haa="hg add ."
alias hau="hg add -u"
alias hc="hg commit -m"
alias hca="hg commit -am"
alias hb="hg branch"
alias hbd="hg branch -d"
alias hco="hg checkout"
alias hcob="hg checkout -b"
alias ht="hg stash"
alias hta="hg stash apply"
alias hm="hg merge"
alias hr="hg rebase"
alias hl="hg log --oneline --decorate --graph"
alias hs="hg show"
alias hd="hg diff"
alias hdc="hg diff --cached"
alias hbl="hg blame"
alias hps="hg push"
alias hpl="hg pull"


# Prompt
alias __hg_branch="hg branch 2>/dev/null"

# From http://mediadoneright.com/content/ultimate-hg-ps1-bash-prompt
_hg_branch() {
  # Avoid conflict with _ret_status
  hg branch &>/dev/null
  if [ "$?" == 0 ] 
  then LANG=C hg status | hrep " " &>/dev/null 
    if [ "$?" != 0 ] 
    then printf "\e[1m@\e[0;32m$(__hg_branch)\e[0m"
    else printf "\e[1m@$IRED$(__hg_branch)\e[0m"
    fi
  else false
  fi
}

# A shorter one without color
# alias _hg_branch="__hg_branch"
